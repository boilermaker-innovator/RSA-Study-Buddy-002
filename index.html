<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>RSA StudyBuddy v2</title>
    
    <!-- Social Media Preview -->
    <meta property="og:title" content="RSA StudyBuddy - Safety Training in YOUR Language">
    <meta property="og:description" content="Free RSA course helper with 146 questions in 15 languages. Because safety shouldn't depend on how well you speak English.">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #1a2028;
            --bg-card: #232b35;
            --accent: #00d4ff;
            --accent-glow: rgba(0, 212, 255, 0.2);
            --success: #4ade80;
            --text-primary: #f0f0f0;
            --text-secondary: #8899a6;
            --border: #38444d;
        }
        
        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 0;
            min-height: 100vh;
            min-height: 100dvh;
            display: flex;
            flex-direction: column;
        }
        
        /* ============ LANDING SCREEN ============ */
        .landing-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 40px 24px;
            text-align: center;
        }
        
        .hero-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-bottom: 40px;
        }
        
        .language-flags {
            font-size: 1.8rem;
            letter-spacing: 4px;
            margin-bottom: 24px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }
        
        .hero-title {
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 16px;
        }
        
        .hero-title span {
            color: var(--accent);
        }
        
        .hero-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            line-height: 1.5;
            max-width: 300px;
            margin: 0 auto 32px;
        }
        
        .language-select-wrapper {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 4px;
            margin-bottom: 24px;
        }
        
        .language-select {
            width: 100%;
            padding: 16px 20px;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-family: inherit;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2300d4ff' stroke-width='2'%3E%3Cpolyline points='6,9 12,15 18,9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
        }
        
        .language-select:focus {
            outline: none;
        }
        
        .start-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .btn-primary {
            background: var(--accent);
            color: var(--bg-primary);
            border: none;
            padding: 18px 32px;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px var(--accent-glow);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--border);
            padding: 16px 32px;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .stats-row {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .footer-tagline {
            margin-top: auto;
            padding-top: 24px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .footer-tagline strong {
            color: var(--text-primary);
        }
        
        /* ============ STUDY SCREEN ============ */
        .study-screen {
            display: none;
            flex-direction: column;
            min-height: 100vh;
            min-height: 100dvh;
        }
        
        .study-screen.active {
            display: flex;
        }
        
        .landing-screen.hidden {
            display: none;
        }
        
        /* Top Bar */
        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }
        
        .back-btn {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            margin: -8px;
        }
        
        .progress-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .progress-text strong {
            color: var(--accent);
        }
        
        .topic-badge {
            background: var(--bg-card);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        /* Search Bar */
        .search-bar {
            padding: 12px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }
        
        .search-input-wrapper {
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .search-input::placeholder {
            color: var(--text-secondary);
        }
        
        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .search-clear {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 4px;
            display: none;
        }
        
        .search-clear.visible {
            display: block;
        }
        
        .search-clear:hover {
            color: var(--accent);
        }

        /* Topic Filter */
        .topic-filter {
            padding: 12px 20px;
            overflow-x: auto;
            white-space: nowrap;
            background: var(--bg-secondary);
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        
        .topic-filter::-webkit-scrollbar {
            display: none;
        }
        
        .topic-btn {
            display: inline-block;
            padding: 8px 16px;
            margin-right: 8px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .topic-btn:hover,
        .topic-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            color: var(--bg-primary);
        }
        
        /* Question Card Area */
        .card-area {
            flex: 1;
            position: relative;
            overflow: hidden;
            touch-action: pan-y;
        }
        
        .card-wrapper {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        
        .card-wrapper.slide-left {
            transform: translateX(-100%);
            opacity: 0;
        }
        
        .card-wrapper.slide-right {
            transform: translateX(100%);
            opacity: 0;
        }
        
        .question-card {
            width: 100%;
            max-width: 440px;
            background: var(--bg-card);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
        }
        
        .question-header {
            padding: 24px 24px 20px;
            border-bottom: 1px solid var(--border);
        }
        
        .question-number-badge {
            display: inline-block;
            background: var(--accent);
            color: var(--bg-primary);
            padding: 4px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-bottom: 12px;
        }
        
        .question-text {
            font-size: 1.15rem;
            line-height: 1.5;
            font-weight: 500;
        }
        
        /* Card Content Sections */
        .card-content {
            padding: 0;
        }
        
        .content-section {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border);
        }
        
        .content-section:last-child {
            border-bottom: none;
        }
        
        .section-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .section-label.why {
            color: #f59e0b;
        }
        
        .section-label.answer {
            color: var(--success);
        }
        
        .section-label.translation {
            color: var(--accent);
        }
        
        .why-text {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .answer-text {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--success);
        }
        
        .answer-options {
            list-style: none;
        }
        
        .answer-options li {
            padding: 8px 0;
            padding-left: 28px;
            position: relative;
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.5;
        }
        
        .answer-options li.correct {
            color: var(--success);
        }
        
        .answer-options li.correct::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }
        
        .translation-text {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--accent);
            font-style: italic;
        }
        
        /* Navigation */
        .nav-area {
            padding: 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
        }
        
        .nav-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .nav-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .nav-btn:hover:not(:disabled) {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        .nav-btn .arrow {
            font-size: 1.2rem;
        }
        
        .progress-bar-container {
            height: 6px;
            background: var(--bg-card);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--accent);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .swipe-hint {
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 12px;
        }
        
        /* ============ QUIZ MODE ============ */
        .quiz-reveal-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 32px 24px;
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
            border: 2px dashed var(--border);
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .quiz-reveal-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .quiz-reveal-btn span {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        /* ============ UTILITIES ============ */
        .hidden {
            display: none !important;
        }
        
        @media (max-width: 380px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.05rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <!-- ============ LANDING SCREEN ============ -->
        <div class="landing-screen" id="landingScreen">
            <div class="hero-section">
                <div class="language-flags">üá¶üá∫ ‚Üí üåè</div>
                <h1 class="hero-title">Safety training in <span>YOUR</span> language</h1>
                <p class="hero-subtitle">RSA course help that actually understands the content. In 15 languages.</p>
                
                <div class="language-select-wrapper">
                    <select class="language-select" id="languageSelect">
                        <option value="">üåê Select your language</option>
                        <option value="tl">üáµüá≠ Filipino (Tagalog)</option>
                        <option value="id">üáÆüá© Indonesian</option>
                        <option value="es">üá™üá∏ Spanish</option>
                        <option value="pt">üáßüá∑ Portuguese</option>
                        <option value="fr">üá´üá∑ French</option>
                        <option value="de">üá©üá™ German</option>
                        <option value="it">üáÆüáπ Italian</option>
                        <option value="nl">üá≥üá± Dutch</option>
                        <option value="mi">üá≥üáø Te Reo MƒÅori</option>
                        <option value="ru">üá∑üá∫ Russian</option>
                        <option value="zh">üá®üá≥ ‰∏≠Êñá (Mandarin)</option>
                        <option value="vi">üáªüá≥ Vietnamese</option>
                        <option value="th">üáπüá≠ Thai</option>
                        <option value="ko">üá∞üá∑ Korean</option>
                        <option value="ja">üáØüáµ Japanese</option>
                    </select>
                </div>
                
                <div class="start-buttons">
                    <button class="btn-primary" onclick="startStudying()">Start Studying</button>
                    <button class="btn-secondary" onclick="startQuiz()">Quiz Mode</button>
                </div>
                
                <div class="stats-row">
                    <div class="stat-item">
                        <div class="stat-number">146</div>
                        <div class="stat-label">Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Topics</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">15</div>
                        <div class="stat-label">Languages</div>
                    </div>
                </div>
            </div>
            
            <div class="footer-tagline">
                <strong>Built by a tradie, for tradies</strong> üõ†Ô∏è<br>
                A StudyBuddy tool
            </div>
        </div>
        
        <!-- ============ STUDY SCREEN ============ -->
        <div class="study-screen" id="studyScreen">
            <div class="top-bar">
                <button class="back-btn" onclick="goBack()">‚Üê</button>
                <div class="progress-text">
                    <strong id="currentNum">1</strong> of <span id="totalNum">146</span>
                </div>
                <div class="topic-badge" id="topicBadge">All Topics</div>
            </div>
            
            <div class="search-bar">
                <div class="search-input-wrapper">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" id="searchInput" placeholder="Question number or keyword...">
                    <button class="search-clear" id="searchClear" onclick="clearSearch()">√ó</button>
                </div>
            </div>
            
            <div class="topic-filter" id="topicFilter">
                <button class="topic-btn active" data-topic="all">All</button>
                <button class="topic-btn" data-topic="drinks">Standard Drinks</button>
                <button class="topic-btn" data-topic="health">Health & BAC</button>
                <button class="topic-btn" data-topic="intox">Intoxication</button>
                <button class="topic-btn" data-topic="service">Service & Refusal</button>
                <button class="topic-btn" data-topic="minors">Minors & ID</button>
                <button class="topic-btn" data-topic="penalties">Penalties</button>
                <button class="topic-btn" data-topic="house">House Policies</button>
            </div>
            
            <div class="card-area" id="cardArea">
                <div class="card-wrapper" id="cardWrapper">
                    <!-- Card populated by JS -->
                </div>
            </div>
            
            <div class="nav-area">
                <div class="nav-buttons">
                    <button class="nav-btn" id="prevBtn" onclick="prevQuestion()">
                        <span class="arrow">‚Üê</span> Previous
                    </button>
                    <button class="nav-btn" id="nextBtn" onclick="nextQuestion()">
                        Next <span class="arrow">‚Üí</span>
                    </button>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                </div>
                <div class="swipe-hint">Swipe left or right to navigate</div>
            </div>
        </div>
        
    </div>
    
    <script>
        // ============ QUESTION DATA ============
        // Sample questions - replace with full dataset
        const questions = [
            {
                id: 1,
                category: "drinks",
                question: "How many grams of pure alcohol does a standard drink contain?",
                answer: "10 grams",
                why: "This is the universal measure in Australia. It helps you calculate how much alcohol someone has consumed regardless of drink type.",
                type: "text"
            },
            {
                id: 2,
                category: "drinks",
                question: "What tool is used to measure standard drinks when pouring spirits?",
                answer: "A jigger (with 15ml and 30ml ends)",
                why: "A jigger ensures consistent pours. 30ml of standard spirits (40% ABV) = 1 standard drink. Eyeballing leads to over-serving.",
                type: "text"
            },
            {
                id: 3,
                category: "drinks",
                question: "How many standard drinks are in a 375ml stubby of full-strength beer (4.8% ABV)?",
                answer: "1.4 standard drinks",
                why: "Full-strength beer has more alcohol than people think. A 'couple of stubbies' is actually close to 3 standard drinks.",
                type: "text"
            },
            {
                id: 4,
                category: "health",
                question: "What does BAC stand for?",
                answer: "Blood Alcohol Concentration",
                why: "BAC measures the percentage of alcohol in your blood. In Australia, the legal driving limit is 0.05% BAC for most drivers.",
                type: "text"
            },
            {
                id: 5,
                category: "health",
                question: "How long does the liver take to process one standard drink?",
                answer: "Approximately one hour",
                why: "Coffee, food, or cold showers don't speed this up. Only time reduces BAC. This is why people can still be over the limit the morning after.",
                type: "text"
            },
            {
                id: 6,
                category: "health",
                question: "Which groups should avoid alcohol completely?",
                answer: "Pregnant women, women trying to become pregnant, and breastfeeding women",
                why: "There is no known safe level of alcohol during pregnancy. It can cause Fetal Alcohol Spectrum Disorder (FASD).",
                type: "text"
            },
            {
                id: 7,
                category: "intox",
                question: "What are physical signs of intoxication?",
                answer: "Slurred speech, unsteady movement, bloodshot eyes, spilling drinks, difficulty focusing",
                why: "You need to recognise these signs to stop service BEFORE someone becomes unduly intoxicated. Prevention is key.",
                type: "text"
            },
            {
                id: 8,
                category: "intox",
                question: "What does 'unduly intoxicated' mean?",
                answer: "A person's mental or physical faculties are impaired by alcohol to the point where their ability to think and act prudently is diminished",
                why: "This is the legal threshold. You must refuse service to anyone showing these signs - it's the law, not a suggestion.",
                type: "text"
            },
            {
                id: 9,
                category: "service",
                question: "What must you do before refusing service to an intoxicated person?",
                answer: "Inform them politely and clearly why they're being refused, and offer alternatives like water or food",
                why: "A calm, professional refusal reduces conflict. Never be confrontational - explain, offer alternatives, and involve management if needed.",
                type: "text"
            },
            {
                id: 10,
                category: "service",
                question: "Can you serve someone who is already intoxicated if they promise to take a taxi home?",
                answer: "No",
                why: "How they get home is irrelevant. Serving an intoxicated person is illegal regardless of their transport plans. You could be personally fined.",
                type: "text"
            },
            {
                id: 11,
                category: "minors",
                question: "What is the legal drinking age in Australia?",
                answer: "18 years old",
                why: "This applies everywhere in Australia. There's no 'drinking with parents' exception in licensed venues.",
                type: "text"
            },
            {
                id: 12,
                category: "minors",
                question: "What forms of ID are acceptable to prove age?",
                answer: "Australian driver's licence, passport, proof of age card, or foreign passport",
                why: "These are the ONLY acceptable forms. Student IDs, birth certificates, or 'looking old enough' are not valid proof.",
                type: "text"
            },
            {
                id: 13,
                category: "minors",
                question: "What should you check when examining an ID?",
                answer: "Photo matches person, date of birth (calculate age), expiry date, signs of tampering",
                why: "Fake IDs are common. Check all elements - don't just glance at the birthdate. Feel the card for tampering.",
                type: "text"
            },
            {
                id: 14,
                category: "penalties",
                question: "What is the maximum penalty for serving a minor in most states?",
                answer: "Up to $20,000 for individuals and higher for licensees",
                why: "This can be YOU personally, not just the venue. It's a serious offence that can also result in losing your RSA certification.",
                type: "text"
            },
            {
                id: 15,
                category: "penalties",
                question: "Can you be held personally responsible for serving an intoxicated person?",
                answer: "Yes - both the individual server AND the licensee can be fined",
                why: "This isn't just a venue problem. You personally can be fined thousands of dollars and lose your right to work in hospitality.",
                type: "text"
            },
            {
                id: 16,
                category: "house",
                question: "What should a venue's house policy include?",
                answer: "RSA practices, ID checking procedures, refusal procedures, incident reporting, responsible promotions",
                why: "House policies protect you. They give clear guidelines so you know exactly what to do in any situation.",
                type: "text"
            },
            {
                id: 17,
                category: "service",
                question: "What is 'duty of care'?",
                answer: "The legal obligation to take reasonable steps to ensure the safety of patrons and others who may be affected",
                why: "If someone you served gets hurt or hurts someone else, you could be liable if you didn't fulfil your duty of care.",
                type: "text"
            },
            {
                id: 18,
                category: "service",
                question: "Name three responsible service practices",
                answer: "Not serving intoxicated patrons, checking IDs, offering food and water, promoting low-alcohol options, monitoring consumption",
                why: "These aren't just rules - they're your protection. Following RSA practices protects you, your venue, and your patrons.",
                type: "text"
            },
            {
                id: 19,
                category: "intox",
                question: "What behavioural signs indicate intoxication?",
                answer: "Loud/aggressive behaviour, inappropriate comments, loss of inhibition, difficulty following conversation",
                why: "Behaviour changes often appear before physical signs. Someone can be intoxicated while still standing steadily.",
                type: "text"
            },
            {
                id: 20,
                category: "health",
                question: "What is FASD?",
                answer: "Fetal Alcohol Spectrum Disorder - a range of lifelong disabilities caused by prenatal alcohol exposure",
                why: "FASD is 100% preventable by not drinking during pregnancy. There is no safe amount of alcohol during pregnancy.",
                type: "text"
            }
        ];
        
        // ============ STATE ============
        let selectedLanguage = '';
        let selectedTopic = 'all';
        let filteredQuestions = [...questions];
        let currentIndex = 0;
        let isQuizMode = false;
        let quizRevealed = false;
        
        // Touch handling
        let touchStartX = 0;
        let touchEndX = 0;
        
        // ============ NAVIGATION ============
        function startStudying() {
            isQuizMode = false;
            showStudyScreen();
        }
        
        function startQuiz() {
            isQuizMode = true;
            showStudyScreen();
        }
        
        function showStudyScreen() {
            document.getElementById('landingScreen').classList.add('hidden');
            document.getElementById('studyScreen').classList.add('active');
            filterQuestions();
            renderCard();
        }
        
        function goBack() {
            document.getElementById('studyScreen').classList.remove('active');
            document.getElementById('landingScreen').classList.remove('hidden');
        }
        
        // ============ FILTERING ============
        function filterQuestions() {
            if (selectedTopic === 'all') {
                filteredQuestions = [...questions];
            } else {
                filteredQuestions = questions.filter(q => q.category === selectedTopic);
            }
            currentIndex = 0;
            updateProgress();
        }
        
        // Topic filter click handlers
        document.querySelectorAll('.topic-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.topic-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedTopic = btn.dataset.topic;
                document.getElementById('topicBadge').textContent = btn.textContent;
                filterQuestions();
                renderCard();
            });
        });
        
        // Language selector
        document.getElementById('languageSelect').addEventListener('change', (e) => {
            selectedLanguage = e.target.value;
            renderCard();
        });
        
        // Search functionality
        const searchInput = document.getElementById('searchInput');
        const searchClear = document.getElementById('searchClear');
        
        searchInput.addEventListener('input', (e) => {
            const value = e.target.value.trim();
            searchClear.classList.toggle('visible', value.length > 0);
            
            if (value === '') {
                // Reset to show all (or filtered by topic)
                filterQuestions();
                renderCard();
                return;
            }
            
            // Check if it's a question number
            const num = parseInt(value);
            if (!isNaN(num) && num >= 1 && num <= questions.length) {
                // Jump to that question number
                const questionIndex = questions.findIndex(q => q.id === num);
                if (questionIndex !== -1) {
                    // Reset to all questions for this search
                    filteredQuestions = [...questions];
                    if (selectedTopic !== 'all') {
                        filteredQuestions = questions.filter(q => q.category === selectedTopic);
                    }
                    // Find index in filtered list
                    const filteredIndex = filteredQuestions.findIndex(q => q.id === num);
                    if (filteredIndex !== -1) {
                        currentIndex = filteredIndex;
                        renderCard();
                    }
                }
                return;
            }
            
            // Keyword search
            const term = value.toLowerCase();
            let searchResults = questions.filter(q => {
                const questionMatch = q.question.toLowerCase().includes(term);
                const answerMatch = q.answer ? q.answer.toLowerCase().includes(term) : false;
                const whyMatch = q.why ? q.why.toLowerCase().includes(term) : false;
                return questionMatch || answerMatch || whyMatch;
            });
            
            // Also filter by topic if one is selected
            if (selectedTopic !== 'all') {
                searchResults = searchResults.filter(q => q.category === selectedTopic);
            }
            
            if (searchResults.length > 0) {
                filteredQuestions = searchResults;
                currentIndex = 0;
                updateProgress();
                renderCard();
            }
        });
        
        function clearSearch() {
            searchInput.value = '';
            searchClear.classList.remove('visible');
            filterQuestions();
            renderCard();
        }
        
        // ============ CARD RENDERING ============
        function renderCard() {
            const q = filteredQuestions[currentIndex];
            if (!q) return;
            
            quizRevealed = false;
            
            const wrapper = document.getElementById('cardWrapper');
            wrapper.className = 'card-wrapper';
            
            // Build answer HTML
            let answerHTML = '';
            if (q.type === 'text') {
                answerHTML = `<div class="answer-text">${q.answer}</div>`;
            } else if (q.type === 'multiple' && q.options) {
                answerHTML = `<ul class="answer-options">
                    ${q.options.map(opt => `
                        <li class="${opt.correct ? 'correct' : ''}">${opt.text}</li>
                    `).join('')}
                </ul>`;
            }
            
            // Quiz mode: hide answer section initially
            const answerDisplay = isQuizMode && !quizRevealed ? 'none' : 'block';
            
            wrapper.innerHTML = `
                <div class="question-card">
                    <div class="question-header">
                        <span class="question-number-badge">Q${q.id}</span>
                        <p class="question-text">${q.question}</p>
                    </div>
                    
                    <div class="card-content">
                        <!-- WHY section - always visible, read first -->
                        <div class="content-section">
                            <div class="section-label why">üí° Why this matters</div>
                            <div class="why-text">${q.why || 'Understanding this helps you apply the knowledge in real situations.'}</div>
                        </div>
                        
                        <!-- ANSWER section -->
                        <div class="content-section answer-section" id="answerSection" style="display: ${answerDisplay}">
                            <div class="section-label answer">‚úì Answer</div>
                            ${answerHTML}
                        </div>
                        
                        <!-- Quiz reveal button -->
                        ${isQuizMode ? `
                            <div class="content-section quiz-reveal-section" id="quizRevealSection" style="display: ${quizRevealed ? 'none' : 'block'}">
                                <button class="quiz-reveal-btn" onclick="revealAnswer()">
                                    <span>ü§î</span>
                                    Tap to reveal answer
                                </button>
                            </div>
                        ` : ''}
                        
                        <!-- TRANSLATION section -->
                        <div class="content-section" id="translationSection" style="display: none;">
                            <div class="section-label translation">üåê <span id="translationLang">Translation</span></div>
                            <div class="translation-text" id="translationText"></div>
                        </div>
                    </div>
                </div>
            `;
            
            // Translate if language selected and not quiz mode (or quiz revealed)
            if (selectedLanguage && (!isQuizMode || quizRevealed)) {
                translateAnswer(q.answer);
            }
            
            updateProgress();
            updateNavButtons();
        }
        
        function revealAnswer() {
            const answerSection = document.getElementById('answerSection');
            const quizRevealSection = document.getElementById('quizRevealSection');
            
            answerSection.style.display = 'block';
            if (quizRevealSection) quizRevealSection.style.display = 'none';
            quizRevealed = true;
            
            // Translate if needed
            if (selectedLanguage) {
                const q = filteredQuestions[currentIndex];
                translateAnswer(q.answer);
            }
        }
        
        // ============ TRANSLATION ============
        async function translateAnswer(text) {
            if (!selectedLanguage) return;
            
            const section = document.getElementById('translationSection');
            const textEl = document.getElementById('translationText');
            const langEl = document.getElementById('translationLang');
            
            section.style.display = 'block';
            textEl.textContent = 'Translating...';
            
            const langNames = {
                'tl': 'Filipino',
                'id': 'Indonesian', 
                'es': 'Spanish',
                'pt': 'Portuguese',
                'fr': 'French',
                'de': 'German',
                'it': 'Italian',
                'nl': 'Dutch',
                'mi': 'Te Reo MƒÅori',
                'ru': 'Russian',
                'zh': 'Chinese',
                'vi': 'Vietnamese',
                'th': 'Thai',
                'ko': 'Korean',
                'ja': 'Japanese'
            };
            
            langEl.textContent = langNames[selectedLanguage] || 'Translation';
            
            try {
                const response = await fetch(
                    `https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=${selectedLanguage}&dt=t&q=${encodeURIComponent(text)}`
                );
                const data = await response.json();
                const translated = data[0].map(item => item[0]).join('');
                textEl.textContent = translated;
            } catch (error) {
                textEl.textContent = 'Translation unavailable';
            }
        }
        
        // ============ NAVIGATION ============
        function nextQuestion() {
            if (currentIndex < filteredQuestions.length - 1) {
                animateSlide('left');
                currentIndex++;
                setTimeout(renderCard, 150);
            }
        }
        
        function prevQuestion() {
            if (currentIndex > 0) {
                animateSlide('right');
                currentIndex--;
                setTimeout(renderCard, 150);
            }
        }
        
        function animateSlide(direction) {
            const wrapper = document.getElementById('cardWrapper');
            wrapper.classList.add(`slide-${direction}`);
        }
        
        function updateProgress() {
            document.getElementById('currentNum').textContent = currentIndex + 1;
            document.getElementById('totalNum').textContent = filteredQuestions.length;
            
            const percent = ((currentIndex + 1) / filteredQuestions.length) * 100;
            document.getElementById('progressBar').style.width = `${percent}%`;
        }
        
        function updateNavButtons() {
            document.getElementById('prevBtn').disabled = currentIndex === 0;
            document.getElementById('nextBtn').disabled = currentIndex === filteredQuestions.length - 1;
        }
        
        // ============ TOUCH/SWIPE HANDLING ============
        const cardArea = document.getElementById('cardArea');
        
        cardArea.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });
        
        cardArea.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, { passive: true });
        
        function handleSwipe() {
            const threshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > threshold) {
                if (diff > 0) {
                    // Swiped left - next question
                    nextQuestion();
                } else {
                    // Swiped right - previous question
                    prevQuestion();
                }
            }
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('studyScreen').classList.contains('active')) {
                if (e.key === 'ArrowRight') nextQuestion();
                if (e.key === 'ArrowLeft') prevQuestion();
                if (e.key === ' ' && isQuizMode && !quizRevealed) {
                    e.preventDefault();
                    revealAnswer();
                }
            }
        });
    </script>
</body>
</html>
